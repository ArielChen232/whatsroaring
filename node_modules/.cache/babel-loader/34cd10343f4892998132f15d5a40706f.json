{"ast":null,"code":"import _classCallCheck from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\n\nvar _this = this;\n\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\n\nvar Cas = function Cas() {\n  _classCallCheck(this, Cas);\n\n  this.casURL = 'https://fed.princeton.edu/cas/';\n  this.url = 'http://localhost:8000/';\n  this.front_url = 'http://localhost:3000/';\n} // this.front_url = 'http://whatsroaring.herokuapp.com/'\n;\n\nexport { Cas as default };\n\nvalidate = function validate(ticket) {\n  var val_url = _this.casURL + 'validate?service=' + encodeURIComponent(_this.serviceURL()) + '&ticket=' + encodeURIComponent(ticket);\n  console.log('validate url = ' + val_url);\n  var request = new XMLHttpRequest();\n  request.open('GET', val_url, true);\n  request.send();\n\n  request.onreadystatechange = function () {\n    console.log('url opened');\n\n    if (request.readyState === 4 && request.status === 200) {\n      var lines = request.responseText;\n      console.log('lines' + lines);\n      return lines;\n    }\n  };\n\n  console.log(\"didn't read correctly\");\n  return null;\n};\n\nauthenticate = function authenticate() {\n  // const query = new URLSearchParams(window.location.href)\n  // var ticket = query.get('ticket')\n  var return_url = _this.front_url + 'calendar'; // const return_url = 'http://whatsroaring.herokuapp.com/?netid='\n  // var ticket = window.location.search.replace(\"?\", ''); // remove the ?\n\n  var urlParams = new URLSearchParams(window.location.search);\n  var ticket = urlParams.get('ticket');\n  console.log('ticket: ' + ticket);\n\n  if (ticket) {\n    console.log('ticket received');\n\n    var netid = _this.validate(ticket);\n\n    if (netid) {\n      sessionStorage.setItem('netid', netid); // window.location.href = return_url\n\n      return;\n    }\n  } // No valid ticket; redirect the browser to the login page to get one\n\n\n  console.log('no ticket found');\n  var login_url = _this.casURL + 'login?service=' + encodeURIComponent(_this.front_url);\n  console.log('Location: ' + login_url); // window.location.href = login_url\n};\n\nserviceURL = function serviceURL() {\n  var url = window.location.href; // Remove the \"ticket\" parameter from the URL.\n\n  url = url.split(\"?\")[0]; // Remove a trailing question mark and/or ampersand.\n\n  url = url.replace(\"\\\\?&?$|&$\", \"\"); // add calendar extension\n\n  url = url + '/calendar';\n  console.log('url:' + url);\n  return url;\n};","map":{"version":3,"sources":["/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/src/Pages/CASClient.js"],"names":["React","Component","withRouter","Cas","casURL","url","front_url","validate","ticket","val_url","encodeURIComponent","serviceURL","console","log","request","XMLHttpRequest","open","send","onreadystatechange","readyState","status","lines","responseText","authenticate","return_url","urlParams","URLSearchParams","window","location","search","get","netid","sessionStorage","setItem","login_url","href","split","replace"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,UAAT,QAA2B,kBAA3B;;IAEqBC,G;;;OACnBC,M,GAAS,gC;OAETC,G,GAAM,wB;OACNC,S,GAAY,wB;EACZ;;;SALmBH,G;;AAQnBI,QAAQ,GAAG,kBAACC,MAAD,EAAY;AACrB,MAAMC,OAAO,GAAI,KAAI,CAACL,MAAL,GAAc,mBAAd,GACbM,kBAAkB,CAAC,KAAI,CAACC,UAAL,EAAD,CADL,GAC2B,UAD3B,GAEbD,kBAAkB,CAACF,MAAD,CAFtB;AAGAI,EAAAA,OAAO,CAACC,GAAR,CAAY,oBAAoBJ,OAAhC;AACA,MAAIK,OAAO,GAAG,IAAIC,cAAJ,EAAd;AACAD,EAAAA,OAAO,CAACE,IAAR,CAAa,KAAb,EAAoBP,OAApB,EAA6B,IAA7B;AACAK,EAAAA,OAAO,CAACG,IAAR;;AACAH,EAAAA,OAAO,CAACI,kBAAR,GAA6B,YAAY;AACvCN,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;;AACA,QAAIC,OAAO,CAACK,UAAR,KAAuB,CAAvB,IAA4BL,OAAO,CAACM,MAAR,KAAmB,GAAnD,EAAwD;AACtD,UAAIC,KAAK,GAAGP,OAAO,CAACQ,YAApB;AACAV,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAUQ,KAAtB;AACA,aAAOA,KAAP;AACC;AACF,GAPH;;AAQAT,EAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACA,SAAO,IAAP;AACD,CAlBD;;AAoBAU,YAAY,GAAG,wBAAM;AACnB;AACA;AACA,MAAMC,UAAU,GAAG,KAAI,CAAClB,SAAL,GAAiB,UAApC,CAHmB,CAInB;AACA;;AAEA,MAAMmB,SAAS,GAAG,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAlB;AACA,MAAMrB,MAAM,GAAGiB,SAAS,CAACK,GAAV,CAAc,QAAd,CAAf;AACAlB,EAAAA,OAAO,CAACC,GAAR,CAAY,aAAaL,MAAzB;;AACA,MAAIA,MAAJ,EAAY;AACVI,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;;AACA,QAAIkB,KAAK,GAAG,KAAI,CAACxB,QAAL,CAAcC,MAAd,CAAZ;;AACA,QAAIuB,KAAJ,EAAW;AACPC,MAAAA,cAAc,CAACC,OAAf,CAAuB,OAAvB,EAAgCF,KAAhC,EADO,CAEP;;AACA;AACD;AACJ,GAlBkB,CAmBnB;;;AACAnB,EAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACA,MAAIqB,SAAS,GAAG,KAAI,CAAC9B,MAAL,GAAc,gBAAd,GAAiCM,kBAAkB,CAAC,KAAI,CAACJ,SAAN,CAAnE;AACAM,EAAAA,OAAO,CAACC,GAAR,CAAY,eAAeqB,SAA3B,EAtBmB,CAuBnB;AACD,CAxBD;;AA0BAvB,UAAU,GAAG,sBAAM;AACjB,MAAIN,GAAG,GAAGsB,MAAM,CAACC,QAAP,CAAgBO,IAA1B,CADiB,CAEjB;;AACA9B,EAAAA,GAAG,GAAGA,GAAG,CAAC+B,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAN,CAHiB,CAIjB;;AACA/B,EAAAA,GAAG,GAAGA,GAAG,CAACgC,OAAJ,CAAY,WAAZ,EAAyB,EAAzB,CAAN,CALiB,CAMjB;;AACAhC,EAAAA,GAAG,GAAGA,GAAG,GAAG,WAAZ;AACAO,EAAAA,OAAO,CAACC,GAAR,CAAY,SAASR,GAArB;AACA,SAAOA,GAAP;AACD,CAVD","sourcesContent":["import React, { Component } from 'react'\nimport { withRouter } from 'react-router-dom'\n\nexport default class Cas {\n  casURL = 'https://fed.princeton.edu/cas/'\n  // this.url = 'http://whatsroaring-api.herokuapp.com/'\n  url = 'http://localhost:8000/'\n  front_url = 'http://localhost:3000/'\n  // this.front_url = 'http://whatsroaring.herokuapp.com/'\n}\n\n  validate = (ticket) => {\n    const val_url = (this.casURL + 'validate?service=' +\n        encodeURIComponent(this.serviceURL()) + '&ticket=' +\n        encodeURIComponent(ticket))\n    console.log('validate url = ' + val_url)\n    var request = new XMLHttpRequest();\n    request.open('GET', val_url, true);\n    request.send();\n    request.onreadystatechange = function () {\n      console.log('url opened')\n      if (request.readyState === 4 && request.status === 200) {\n        var lines = request.responseText;\n        console.log('lines' + lines)\n        return lines\n        }\n      }\n    console.log(\"didn't read correctly\")\n    return null\n  }\n\n  authenticate = () => {\n    // const query = new URLSearchParams(window.location.href)\n    // var ticket = query.get('ticket')\n    const return_url = this.front_url + 'calendar'\n    // const return_url = 'http://whatsroaring.herokuapp.com/?netid='\n    // var ticket = window.location.search.replace(\"?\", ''); // remove the ?\n\n    const urlParams = new URLSearchParams(window.location.search);\n    const ticket = urlParams.get('ticket');\n    console.log('ticket: ' + ticket)\n    if (ticket) {\n      console.log('ticket received')\n      var netid = this.validate(ticket)\n      if (netid) {\n          sessionStorage.setItem('netid', netid)\n          // window.location.href = return_url\n          return\n        }\n    }\n    // No valid ticket; redirect the browser to the login page to get one\n    console.log('no ticket found')\n    var login_url = this.casURL + 'login?service=' + encodeURIComponent(this.front_url)\n    console.log('Location: ' + login_url)\n    // window.location.href = login_url\n  }\n\n  serviceURL = () => {\n    var url = window.location.href;\n    // Remove the \"ticket\" parameter from the URL.\n    url = url.split(\"?\")[0];\n    // Remove a trailing question mark and/or ampersand.\n    url = url.replace(\"\\\\?&?$|&$\", \"\");\n    // add calendar extension\n    url = url + '/calendar'\n    console.log('url:' + url)\n    return url;\n  }\n"]},"metadata":{},"sourceType":"module"}