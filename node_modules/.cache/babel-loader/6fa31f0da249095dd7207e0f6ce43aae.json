{"ast":null,"code":"import _defineProperty from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/src/Pages/Calendar.js\";\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport moment from 'moment'; // Components\n\nimport BigCalendar from 'react-big-calendar';\nimport DropdownMultiple from './Components/DropdownMultiple';\nimport AddEventButton from './Components/AddEventButton';\nimport AddOrgButton from './Components/AddOrgButton';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox from '@material-ui/core/Checkbox'; // Styling\n\nimport 'react-big-calendar/lib/css/react-big-calendar.css';\nimport './Calendar.css';\nvar localizer = BigCalendar.momentLocalizer(moment);\nvar url = 'https://whatsroaring-api.herokuapp.com/'; // const url = 'http://127.0.0.1:8000/'\n\nvar orange = '#fb8c00'; //let imgUrl = 'homepage_background.png'\n\n/*var sectionStyle = {\n  width: \"100%\",\n  height: \"100%\",\n  backgroundImage: 'url(' + imgUrl + ')',\n  backgroundSize: 'cover',\n  backgroundPosition: 'center center',\n  backgroundRepeat: 'no-repeat',\n};*/\n\n/*function getOrgName(orgPk, callback) {\n  const url_orgName = url + 'getOrgName/' + orgPk;\n  var orgname;\n  axios.get(url_orgName).then(res => {\n    const posts = JSON.parse(res.data.data)\n    if (posts.length >= 1) {\n      orgname = posts[0].fields.name;\n      callback(orgname)\n    }\n  })\n}*/\n// return array of location objects to populate dropdown\n\nfunction getLocationObjects() {\n  var url_locs = url + 'getLocations';\n  var locs_arr = [];\n  axios.get(url_locs).then(function (res) {\n    var locs = res.data.locs;\n    locs.sort(compareDropdown);\n\n    for (var i = 0; i < locs.length; i++) {\n      locs_arr.push({\n        id: i,\n        title: locs[i],\n        selected: false,\n        key: 'locations'\n      });\n    }\n  });\n  return locs_arr;\n} // return array of category objects to populate dropdown\n\n\nfunction getCategoryObjects() {\n  var url_cats = url + 'getCategories';\n  var cats_arr = [];\n  axios.get(url_cats).then(function (res) {\n    var cats = res.data.cats;\n    cats.sort(compareDropdown);\n\n    for (var i = 0; i < cats.length; i++) {\n      cats_arr.push({\n        id: i,\n        title: cats[i],\n        selected: false,\n        key: 'categories'\n      });\n    }\n  });\n  return cats_arr;\n} // return array of organization objects to populate dropdown\n\n\nfunction getOrganizationObjects() {\n  var url_orgs = url + 'getOrganizations';\n  var orgs_arr = [];\n  axios.get(url_orgs).then(function (res) {\n    var orgs = res.data.orgs;\n    orgs.sort(compareDropdown);\n\n    for (var i = 0; i < orgs.length; i++) {\n      orgs_arr.push({\n        id: i,\n        title: orgs[i],\n        selected: false,\n        key: 'organizations'\n      });\n    }\n  });\n  return orgs_arr;\n} // function to sort dropdown components\n\n\nfunction compareDropdown(a, b) {\n  var compA = a.toUpperCase();\n  var compB = b.toUpperCase();\n  if (compA < compB) return -1;\n  if (compA > compB) return 1;\n  return 0;\n}\n\nvar Calendar =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Calendar, _Component);\n\n  function Calendar() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Calendar);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Calendar)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.handleCheckFree = function (name) {\n      console.log(\"free_selected\");\n\n      _this.setState({\n        checkedFree: !_this.state.checkedFree\n      }, function () {\n        return _this.filterEvents();\n      });\n    };\n\n    _this.handleCheckFav = function (name) {\n      console.log(\"fav_selected\");\n\n      _this.setState({\n        checkedFav: !_this.state.checkedFav\n      }, function () {\n        return _this.filterEvents();\n      });\n    };\n\n    _this.onStartChange = function (date) {\n      _this.setState({\n        start_datetime: date\n      });\n    };\n\n    _this.onEndChange = function (date) {\n      _this.setState({\n        end_datetime: date\n      });\n    };\n\n    _this.toggleSelected = function (id, key) {\n      var temp = JSON.parse(JSON.stringify(_this.state[key]));\n      temp[id].selected = !temp[id].selected;\n      console.log(\"toggled\");\n\n      _this.setState(_defineProperty({}, key, temp), function () {\n        return _this.filterEvents();\n      });\n    };\n\n    _this.seeDetails = function (event) {\n      console.log('Org: ' + event.org);\n\n      _this.props.changeToDetails(event);\n\n      _this.props.history.push('/details');\n    };\n\n    _this.seeDetails = function (event) {\n      console.log('Org: ' + event.org);\n\n      _this.props.changeToDetails(event);\n\n      _this.props.history.push('/details');\n    };\n\n    _this.state = {\n      events: [],\n      netid: 'rachelsc',\n      locations: [],\n      categories: [],\n      organizations: [],\n      checkedFree: false,\n      checkedFav: false,\n      start_datetime: new Date(),\n      end_datetime: new Date()\n    };\n    _this.eventStyleGetter = _this.eventStyleGetter.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Calendar, [{\n    key: \"getStateFromStorage\",\n    value: function getStateFromStorage(callback) {\n      console.log('state gotten');\n      var state = {};\n\n      for (var key in this.state) {\n        console.log(key); // if the key exists in sessionStorage\n\n        if (sessionStorage.hasOwnProperty(key)) {\n          // get the key's value from sessionStorage\n          var value = sessionStorage.getItem(key);\n          console.log(value); // parse the sessionStorage string and setState\n\n          try {\n            value = JSON.parse(value);\n            state[key] = value;\n          } catch (e) {// handle empty string\n          }\n        }\n      }\n\n      console.log(state);\n      return state;\n    }\n  }, {\n    key: \"saveStateToStorage\",\n    value: function saveStateToStorage() {\n      // save state to local storage so it can be loaded\n      console.log('state saved');\n\n      for (var key in this.state) {\n        if (key !== 'events') {\n          sessionStorage.setItem(key, JSON.stringify(this.state[key]));\n        }\n      }\n    }\n  }, {\n    key: \"updateCalendar\",\n    value: function updateCalendar() {\n      var _this2 = this;\n\n      var locations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      var categories = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n      var organizations = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n      var is_free = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"\";\n      var start_date = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"\";\n      var end_date = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : \"\";\n      var netid = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : \"rachelsc\";\n      var favorites = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : \"\";\n      // empty string for parameters indicates select all of them\n      // Repopulate calendar\n      var url_getEvents = url + 'getEvents';\n      var events = [];\n      axios.get(url_getEvents, {\n        params: {\n          locations: locations,\n          categories: categories,\n          organizations: organizations,\n          is_free: is_free,\n          netid: netid,\n          favorites: favorites\n        }\n      }).then(function (res) {\n        var posts = JSON.parse(res.data.Events_JSON); // UNCOMMENT THIS TO FIX\n        // posts.forEach((post) => {\n        //   events.push({\n        //     title: post.fields.name,\n        //     start: new Date(post.fields.start_datetime),\n        //     end: new Date(post.fields.end_datetime),\n        //     desc: post.fields.description,\n        //     loc: post.fields.location,\n        //     website: post.fields.website,\n        //     org: '',\n        //     is_free: post.fields.is_free\n        //   })\n        // })\n        // COMMENT THIS BLOCK TO FIX\n\n        posts.forEach(function (post) {\n          getOrgName(post.fields.org, function (orgname) {\n            events.push({\n              title: post.fields.name,\n              start: new Date(post.fields.start_datetime),\n              end: new Date(post.fields.end_datetime),\n              desc: post.fields.description,\n              loc: post.fields.location,\n              website: post.fields.website,\n              org: orgname,\n              is_free: post.fields.is_free\n            });\n          });\n        });\n      }).then(function (res) {\n        console.log(events);\n\n        _this2.setState({\n          events: events\n        });\n      }).catch(function (error) {\n        console.log(error);\n        console.log(error.response.data);\n      });\n    }\n  }, {\n    key: \"filterEvents\",\n    value: function filterEvents() {\n      var i;\n      var locations = \"\";\n      var categories = \"\";\n      var organizations = \"\";\n      var is_free = \"\";\n      var netid = \"rachelsc\";\n      var favorites = \"\";\n\n      for (i = 0; i < this.state.locations.length; i++) {\n        if (this.state.locations[i].selected === true) {\n          locations += this.state.locations[i].title + ',';\n        }\n      }\n\n      for (i = 0; i < this.state.categories.length; i++) {\n        if (this.state.categories[i].selected === true) {\n          categories += this.state.categories[i].title + ',';\n        }\n      }\n\n      for (i = 0; i < this.state.organizations.length; i++) {\n        if (this.state.organizations[i].selected === true) {\n          organizations += this.state.organizations[i].title + ',';\n        }\n      } // remove trailing commas from strings\n\n\n      locations = locations.substr(0, locations.length - 1);\n      categories = categories.substr(0, categories.length - 1);\n      organizations = organizations.substr(0, organizations.length - 1);\n\n      if (this.state.checkedFree === true) {\n        is_free = \"true\";\n      }\n\n      if (this.state.checkedFav === true) {\n        favorites = \"true\";\n      }\n\n      console.log(locations);\n      console.log(categories);\n      console.log(organizations);\n      console.log(is_free);\n      console.log(netid);\n      console.log(favorites);\n      this.updateCalendar(locations = locations, categories = categories, organizations = organizations, is_free = is_free, netid = netid, favorites = favorites);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.updateCalendar();\n      this.setState({\n        locations: getLocationObjects(),\n        categories: getCategoryObjects(),\n        organizations: getOrganizationObjects(),\n        is_free: this.state.checkedFree,\n        netid: this.state.netid,\n        favorites: this.state.checkedFav\n      });\n    }\n  }, {\n    key: \"eventStyleGetter\",\n    value: function eventStyleGetter(event) {\n      var color = orange;\n      /* Can add logic here to color code */\n\n      var style = {\n        backgroundColor: color,\n        opacity: 0.8,\n        color: 'black',\n        border: '0px'\n      };\n      return {\n        style: style\n      };\n    }\n  }, {\n    key: \"validate\",\n    value: function validate() {\n      // const query = new URLSearchParams(this.props.location.search)\n      // if (this.state.netid === '') {\n      //   const url_netid = url + \"netid\"\n      //   axios.get(url_netid)\n      //   .then(res => {\n      //     this.setState({netid: res['data']})\n      //     // this.setState({netid: query.get('netid')})\n      //   })\n      //   .catch(function(error) {\n      //     console.log(error);\n      //   })\n      // }\n      // this.state.netid = 'rachelsc'\n      if (this.state.netid === '') this.setState({\n        netid: 'rachelsc'\n      });\n      sessionStorage.setItem('netid', 'rachelsc');\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      console.log('render');\n      console.log(this.state);\n      var addEvent;\n      var addOrg;\n      var adminList = ['rachelsc', '-'];\n      this.validate();\n      var isAdmin = adminList.includes(this.state.netid);\n\n      if (isAdmin) {\n        addEvent = React.createElement(AddEventButton, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 366\n          },\n          __self: this\n        });\n        addOrg = React.createElement(AddOrgButton, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 367\n          },\n          __self: this\n        });\n      } else {\n        addEvent = React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 370\n          },\n          __self: this\n        });\n        addOrg = React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 371\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        className: \"CalendarPage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 374\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"full-width\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 376\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"Jumbotron\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 377\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"alignleft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383\n        },\n        __self: this\n      }, React.createElement(DropdownMultiple, {\n        titleHelper: \"location\",\n        title: \"Select location\",\n        list: this.state.locations,\n        toggleItem: this.toggleSelected,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 385\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"alignleft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 394\n        },\n        __self: this\n      }, React.createElement(DropdownMultiple, {\n        titleHelper: \"event type\",\n        title: \"Select event type\",\n        list: this.state.categories,\n        toggleItem: this.toggleSelected,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"alignleft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 403\n        },\n        __self: this\n      }, React.createElement(DropdownMultiple, {\n        titleHelper: \"organization\",\n        title: \"Select organization\",\n        list: this.state.organizations,\n        toggleItem: this.toggleSelected,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 404\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"alignright\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 412\n        },\n        __self: this\n      }, addEvent, addOrg), React.createElement(\"div\", {\n        className: \"alignleft\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417\n        },\n        __self: this\n      }, React.createElement(FormGroup, {\n        row: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 419\n        },\n        __self: this\n      }, React.createElement(FormControlLabel, {\n        control: React.createElement(Checkbox, {\n          checked: this.state.checkedA,\n          onChange: this.handleCheckFree,\n          value: \"checkedA\",\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 422\n          },\n          __self: this\n        }),\n        label: \"Free events only\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420\n        },\n        __self: this\n      }), React.createElement(FormControlLabel, {\n        control: React.createElement(Checkbox, {\n          checked: this.state.checkedA,\n          onChange: this.handleCheckFav,\n          value: \"checkedA\",\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 434\n          },\n          __self: this\n        }),\n        label: \"Favorites\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 432\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        className: \"Calendar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448\n        },\n        __self: this\n      }, React.createElement(BigCalendar, {\n        localizer: localizer,\n        events: this.state.events,\n        defaultView: BigCalendar.Views.MONTH,\n        onSelectEvent: this.seeDetails,\n        views: ['month', 'week', 'day'],\n        eventPropGetter: this.eventStyleGetter,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 449\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Calendar;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    /*title: state.eventReducer.title,\n    start: state.eventReducer.start,\n    end: state.eventReducer.end,\n    desc: state.eventReducer.desc,\n    location: state.eventReducer.location,\n    website: state.eventReducer.website,\n    org: state.eventReducer.org,\n    is_free: state.eventReducer.is_free*/\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    changeToDetails: function changeToDetails(event) {\n      return dispatch({\n        type: 'changeToDetails',\n        payload: {\n          title: event.title,\n          start: event.start,\n          end: event.end,\n          desc: event.desc,\n          loc: event.loc,\n          website: event.website,\n          org: event.org,\n          is_free: event.is_free\n        }\n      });\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Calendar));","map":{"version":3,"sources":["/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/src/Pages/Calendar.js"],"names":["React","Component","withRouter","connect","axios","moment","BigCalendar","DropdownMultiple","AddEventButton","AddOrgButton","FormGroup","FormControlLabel","Checkbox","localizer","momentLocalizer","url","orange","getLocationObjects","url_locs","locs_arr","get","then","res","locs","data","sort","compareDropdown","i","length","push","id","title","selected","key","getCategoryObjects","url_cats","cats_arr","cats","getOrganizationObjects","url_orgs","orgs_arr","orgs","a","b","compA","toUpperCase","compB","Calendar","args","handleCheckFree","name","console","log","setState","checkedFree","state","filterEvents","handleCheckFav","checkedFav","onStartChange","date","start_datetime","onEndChange","end_datetime","toggleSelected","temp","JSON","parse","stringify","seeDetails","event","org","props","changeToDetails","history","events","netid","locations","categories","organizations","Date","eventStyleGetter","bind","callback","sessionStorage","hasOwnProperty","value","getItem","e","setItem","is_free","start_date","end_date","favorites","url_getEvents","params","posts","Events_JSON","forEach","post","getOrgName","fields","orgname","start","end","desc","description","loc","location","website","catch","error","response","substr","updateCalendar","color","style","backgroundColor","opacity","border","addEvent","addOrg","adminList","validate","isAdmin","includes","checkedA","Views","MONTH","mapStateToProps","mapDispatchToProps","dispatch","type","payload"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withRouter } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport axios from 'axios'\nimport moment from 'moment'\n\n// Components\nimport BigCalendar from 'react-big-calendar'\nimport DropdownMultiple from './Components/DropdownMultiple'\nimport AddEventButton from './Components/AddEventButton'\nimport AddOrgButton from './Components/AddOrgButton'\nimport FormGroup from '@material-ui/core/FormGroup'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Checkbox from '@material-ui/core/Checkbox'\n\n// Styling\nimport 'react-big-calendar/lib/css/react-big-calendar.css'\nimport './Calendar.css'\n\n\nconst localizer = BigCalendar.momentLocalizer(moment)\nconst url = 'https://whatsroaring-api.herokuapp.com/'\n// const url = 'http://127.0.0.1:8000/'\nconst orange = '#fb8c00'\n\n//let imgUrl = 'homepage_background.png'\n\n/*var sectionStyle = {\n  width: \"100%\",\n  height: \"100%\",\n  backgroundImage: 'url(' + imgUrl + ')',\n  backgroundSize: 'cover',\n  backgroundPosition: 'center center',\n  backgroundRepeat: 'no-repeat',\n};*/\n\n\n/*function getOrgName(orgPk, callback) {\n  const url_orgName = url + 'getOrgName/' + orgPk;\n  var orgname;\n  axios.get(url_orgName).then(res => {\n    const posts = JSON.parse(res.data.data)\n    if (posts.length >= 1) {\n      orgname = posts[0].fields.name;\n      callback(orgname)\n    }\n  })\n}*/\n\n// return array of location objects to populate dropdown\nfunction getLocationObjects() {\n  const url_locs = url + 'getLocations'\n  var locs_arr = [];\n  axios.get(url_locs).then(res => {\n    var locs = res.data.locs\n    locs.sort(compareDropdown)\n    for (var i = 0; i < locs.length; i++) {\n      locs_arr.push({\n        id: i,\n        title: locs[i],\n        selected: false,\n        key: 'locations'\n      });\n    }\n  })\n  return locs_arr\n}\n\n// return array of category objects to populate dropdown\nfunction getCategoryObjects() {\n  const url_cats = url + 'getCategories'\n  var cats_arr = [];\n  axios.get(url_cats).then(res => {\n    var cats = res.data.cats\n    cats.sort(compareDropdown)\n    for (var i = 0; i < cats.length; i++) {\n      cats_arr.push({\n        id: i,\n        title: cats[i],\n        selected: false,\n        key: 'categories'\n      });\n    }\n  })\n  return cats_arr\n}\n\n// return array of organization objects to populate dropdown\nfunction getOrganizationObjects() {\n  const url_orgs = url + 'getOrganizations'\n  var orgs_arr = [];\n  axios.get(url_orgs).then(res => {\n    var orgs = res.data.orgs\n    orgs.sort(compareDropdown)\n    for (var i = 0; i < orgs.length; i++) {\n      orgs_arr.push({\n        id: i,\n        title: orgs[i],\n        selected: false,\n        key: 'organizations'\n      });\n    }\n  })\n  return orgs_arr\n}\n\n// function to sort dropdown components\nfunction compareDropdown(a, b) {\n  var compA = a.toUpperCase();\n  var compB = b.toUpperCase();\n  if (compA < compB) return -1;\n  if (compA > compB) return 1;\n  return 0;\n}\n\nclass Calendar extends Component {\n  constructor(...args) {\n    super(...args)\n    this.state = {\n      events: [],\n      netid: 'rachelsc',\n      locations: [],\n      categories: [],\n      organizations: [],\n      checkedFree: false,\n      checkedFav: false,\n      start_datetime: new Date(),\n      end_datetime: new Date()\n    }\n    this.eventStyleGetter = this.eventStyleGetter.bind(this)\n  }\n\n  handleCheckFree = name => {\n    console.log(\"free_selected\")\n    this.setState({\n      checkedFree: !this.state.checkedFree\n    }, () => this.filterEvents());\n  };\n\n  handleCheckFav = name => {\n    console.log(\"fav_selected\")\n    this.setState({\n      checkedFav: !this.state.checkedFav\n    }, () => this.filterEvents());\n  };\n\n  onStartChange = date => {\n    this.setState({\n      start_datetime: date })};\n\n  onEndChange = date => {\n    this.setState({\n      end_datetime: date })};\n\n  toggleSelected = (id, key) => {\n    let temp = JSON.parse(JSON.stringify(this.state[key]))\n    temp[id].selected = !temp[id].selected\n    console.log(\"toggled\")\n    this.setState({\n      [key]: temp\n    }, () => this.filterEvents())\n  }\n\n  seeDetails = (event) => {\n    console.log('Org: ' + event.org);\n    this.props.changeToDetails(event);\n    this.props.history.push('/details')\n  }\n\n  getStateFromStorage(callback) {\n    console.log('state gotten')\n    var state = {}\n    for (let key in this.state) {\n      console.log(key)\n      // if the key exists in sessionStorage\n      if (sessionStorage.hasOwnProperty(key)) {\n        // get the key's value from sessionStorage\n        let value = sessionStorage.getItem(key);\n        console.log(value)\n        // parse the sessionStorage string and setState\n        try {\n          value = JSON.parse(value);\n          state[key] = value;\n        } catch (e) {\n          // handle empty string\n        }\n      }\n    }\n    console.log(state)\n    return state\n  }\n\n  saveStateToStorage() {\n    // save state to local storage so it can be loaded\n    console.log('state saved')\n    for (let key in this.state) {\n      if (key !== 'events') {\n        sessionStorage.setItem(key, JSON.stringify(this.state[key]));\n      }\n    }\n  }\n\n  updateCalendar(locations=\"\", categories=\"\", organizations=\"\", is_free=\"\",\n  start_date = \"\", end_date = \"\", netid = \"rachelsc\", favorites = \"\") {\n    // empty string for parameters indicates select all of them\n    // Repopulate calendar\n    const url_getEvents = url + 'getEvents'\n    const events = [];\n    axios.get(url_getEvents, {\n      params: {\n        locations: locations,\n        categories: categories,\n        organizations: organizations,\n        is_free: is_free,\n        netid: netid,\n        favorites: favorites\n    }})\n    .then(res => {\n      const posts = JSON.parse(res.data.Events_JSON)\n\n      // UNCOMMENT THIS TO FIX\n      // posts.forEach((post) => {\n      //   events.push({\n      //     title: post.fields.name,\n      //     start: new Date(post.fields.start_datetime),\n      //     end: new Date(post.fields.end_datetime),\n      //     desc: post.fields.description,\n      //     loc: post.fields.location,\n      //     website: post.fields.website,\n      //     org: '',\n      //     is_free: post.fields.is_free\n      //   })\n      // })\n\n      // COMMENT THIS BLOCK TO FIX\n      posts.forEach((post) => {\n        getOrgName(post.fields.org, function(orgname) {\n          events.push({\n            title: post.fields.name,\n            start: new Date(post.fields.start_datetime),\n            end: new Date(post.fields.end_datetime),\n            desc: post.fields.description,\n            loc: post.fields.location,\n            website: post.fields.website,\n            org: orgname,\n            is_free: post.fields.is_free\n          })\n        })\n      })\n    })\n    .then(res => {\n      console.log(events)\n      this.setState({events: events})\n    })\n    .catch(function(error) {\n      console.log(error);\n      console.log(error.response.data);\n    })\n  }\n\n  filterEvents() {\n    var i;\n    var locations = \"\";\n    var categories = \"\";\n    var organizations = \"\";\n    var is_free = \"\";\n    var netid = \"rachelsc\";\n    var favorites = \"\";\n    for (i = 0; i < this.state.locations.length; i++) {\n      if (this.state.locations[i].selected === true) {\n        locations += (this.state.locations[i].title + ',');\n      }\n    }\n    for (i = 0; i < this.state.categories.length; i++) {\n      if (this.state.categories[i].selected === true) {\n        categories += (this.state.categories[i].title + ',');\n      }\n    }\n    for (i = 0; i < this.state.organizations.length; i++) {\n      if (this.state.organizations[i].selected === true) {\n        organizations += (this.state.organizations[i].title + ',');\n      }\n    }\n    // remove trailing commas from strings\n    locations = locations.substr(0, locations.length-1);\n    categories = categories.substr(0, categories.length-1);\n    organizations = organizations.substr(0, organizations.length-1);\n    if (this.state.checkedFree === true) {\n      is_free = \"true\"\n    }\n    if (this.state.checkedFav === true) {\n      favorites = \"true\"\n    }\n    console.log(locations)\n    console.log(categories)\n    console.log(organizations)\n    console.log(is_free)\n    console.log(netid)\n    console.log(favorites)\n    this.updateCalendar(locations=locations,\n                        categories=categories,\n                        organizations=organizations,\n                        is_free=is_free,\n                        netid=netid,\n                        favorites=favorites)\n  }\n\n  componentDidMount() {\n    this.updateCalendar()\n    this.setState({locations:getLocationObjects(),\n                   categories:getCategoryObjects(),\n                   organizations:getOrganizationObjects(),\n                   is_free: this.state.checkedFree,\n                   netid: this.state.netid,\n                   favorites: this.state.checkedFav\n                 })\n  }\n\n  seeDetails = (event) => {\n    console.log('Org: ' + event.org)\n    this.props.changeToDetails(event);\n    this.props.history.push('/details')\n  }\n\n  eventStyleGetter(event) {\n    var color = orange\n    /* Can add logic here to color code */\n    var style = {\n      backgroundColor: color,\n      opacity: 0.8,\n      color: 'black',\n      border: '0px'\n    }\n    return {\n      style: style\n    }\n  }\n\n  validate() {\n    // const query = new URLSearchParams(this.props.location.search)\n    // if (this.state.netid === '') {\n    //   const url_netid = url + \"netid\"\n    //   axios.get(url_netid)\n    //   .then(res => {\n    //     this.setState({netid: res['data']})\n    //     // this.setState({netid: query.get('netid')})\n    //   })\n    //   .catch(function(error) {\n    //     console.log(error);\n    //   })\n    // }\n    // this.state.netid = 'rachelsc'\n    if (this.state.netid === '') this.setState({netid: 'rachelsc'})\n    sessionStorage.setItem('netid', 'rachelsc')\n  }\n\n  render() {\n    console.log('render')\n    console.log(this.state)\n    var addEvent\n    var addOrg\n    const adminList = ['rachelsc', '-']\n    this.validate()\n    const isAdmin = adminList.includes(this.state.netid)\n    if (isAdmin) {\n      addEvent = <AddEventButton/>\n      addOrg = <AddOrgButton/>\n    }\n    else {\n      addEvent = <div></div>\n      addOrg = <div></div>\n    }\n    return (\n    <div className='CalendarPage'>\n\n      <div className = \"full-width\">\n      <div className=\"Jumbotron\">\n      </div>\n      <br>\n\n\n      </br>\n        <div className = \"alignleft\">\n\n          <DropdownMultiple\n            titleHelper=\"location\"\n            title=\"Select location\"\n            list={this.state.locations}\n            toggleItem={this.toggleSelected}\n          />\n          </div>\n\n\n          <div className = \"alignleft\">\n            <DropdownMultiple\n              titleHelper=\"event type\"\n              title=\"Select event type\"\n              list={this.state.categories}\n              toggleItem={this.toggleSelected}\n            />\n          </div>\n\n          <div className = \"alignleft\">\n            <DropdownMultiple\n              titleHelper=\"organization\"\n              title=\"Select organization\"\n              list={this.state.organizations}\n              toggleItem={this.toggleSelected}\n            />\n          </div>\n\n          <div className = \"alignright\">\n            {addEvent}\n            {addOrg}\n          </div>\n\n          <div className = \"alignleft\">\n\n          <FormGroup row>\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={this.state.checkedA}\n                  onChange={this.handleCheckFree}\n                  value=\"checkedA\"\n                  color=\"primary\"\n                />\n              }\n              label=\"Free events only\"\n            />\n\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={this.state.checkedA}\n                  onChange={this.handleCheckFav}\n                  value=\"checkedA\"\n                  color=\"primary\"\n                />\n              }\n              label=\"Favorites\"\n            />\n\n          </FormGroup>\n          </div>\n        </div>\n\n        <div className='Calendar'>\n          <BigCalendar\n            localizer={localizer}\n            events={this.state.events}\n            defaultView={BigCalendar.Views.MONTH}\n            onSelectEvent={this.seeDetails}\n            views={['month', 'week', 'day']}\n            eventPropGetter={(this.eventStyleGetter)}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    /*title: state.eventReducer.title,\n    start: state.eventReducer.start,\n    end: state.eventReducer.end,\n    desc: state.eventReducer.desc,\n    location: state.eventReducer.location,\n    website: state.eventReducer.website,\n    org: state.eventReducer.org,\n    is_free: state.eventReducer.is_free*/\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    changeToDetails: (event) => dispatch({\n      type: 'changeToDetails',\n      payload: {\n        title: event.title,\n        start: event.start,\n        end: event.end,\n        desc: event.desc,\n        loc: event.loc,\n        website: event.website,\n        org: event.org,\n        is_free: event.is_free\n      }\n    })\n  }\n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Calendar))\n"]},"metadata":{},"sourceType":"module"}