{"ast":null,"code":"import _classCallCheck from \"/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\n\nvar Cas = function Cas() {\n  var _this = this;\n\n  _classCallCheck(this, Cas);\n\n  this.casURL = 'https://fed.princeton.edu/cas/';\n\n  this.validate = function (ticket) {\n    var val_url = _this.casURL + 'validate?service=' + encodeURIComponent(_this.serviceURL()) + '&ticket=' + encodeURIComponent(ticket);\n    console.log('validate url = ' + val_url);\n    var request = new XMLHttpRequest();\n    request.open('GET', val_url, true);\n    request.send();\n\n    request.onreadystatechange = function () {\n      console.log('url opened');\n\n      if (request.readyState === 4 && request.status === 200) {\n        var lines = request.responseText;\n        lines = lines.split(\"\\n\");\n\n        if (lines.length == 2 && lines[0] == 'yes') {\n          console.log('netid:' + lines[1]);\n        }\n\n        console.log('lines' + lines);\n        return lines;\n      }\n    };\n\n    return null;\n  };\n\n  this.authenticate = function () {\n    // is username is stored, then they were already authenticated\n    // var netid = localStorage.getItem('netid')\n    // console.log(netid === null)\n    // if (netid) {\n    //   return netid\n    // }\n    // if request has a login ticket, try to validate it\n    var urlParams = new URLSearchParams(window.location.search);\n    var ticket = urlParams.get('ticket');\n    console.log('ticket: ' + ticket);\n\n    if (ticket) {\n      console.log('ticket received');\n\n      var netid = _this.validate(ticket);\n\n      localStorage.setItem('netid', netid);\n      return netid;\n    } // No valid ticket; redirect the browser to the login page to get one\n\n\n    console.log('no ticket found');\n    var login_url = _this.casURL + 'login?service=' + encodeURIComponent(_this.serviceURL());\n    console.log('Location: ' + login_url);\n    window.location.href = login_url;\n  };\n\n  this.serviceURL = function () {\n    var url = window.location.href; // Remove the \"ticket\" parameter from the URL.\n\n    url = url.split(\"?\")[0]; // Remove a trailing question mark and/or ampersand.\n\n    url = url.replace(\"\\\\?&?$|&$\", \"\");\n    console.log('url:' + url);\n    return url;\n  };\n};\n\nexport { Cas as default };","map":{"version":3,"sources":["/Users/clairedu/Desktop/College/cos333/calendar_project/whatsroaring/src/Pages/CASClient.js"],"names":["React","Component","withRouter","Cas","casURL","validate","ticket","val_url","encodeURIComponent","serviceURL","console","log","request","XMLHttpRequest","open","send","onreadystatechange","readyState","status","lines","responseText","split","length","authenticate","urlParams","URLSearchParams","window","location","search","get","netid","localStorage","setItem","login_url","href","url","replace"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,UAAT,QAA2B,kBAA3B;;IAEqBC,G;;;;;OACnBC,M,GAAS,gC;;OAETC,Q,GAAW,UAACC,MAAD,EAAY;AACrB,QAAMC,OAAO,GAAI,KAAI,CAACH,MAAL,GAAc,mBAAd,GACbI,kBAAkB,CAAC,KAAI,CAACC,UAAL,EAAD,CADL,GAC2B,UAD3B,GAEbD,kBAAkB,CAACF,MAAD,CAFtB;AAGAI,IAAAA,OAAO,CAACC,GAAR,CAAY,oBAAoBJ,OAAhC;AACA,QAAIK,OAAO,GAAG,IAAIC,cAAJ,EAAd;AACAD,IAAAA,OAAO,CAACE,IAAR,CAAa,KAAb,EAAoBP,OAApB,EAA6B,IAA7B;AACAK,IAAAA,OAAO,CAACG,IAAR;;AACAH,IAAAA,OAAO,CAACI,kBAAR,GAA6B,YAAY;AACvCN,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;;AACA,UAAIC,OAAO,CAACK,UAAR,KAAuB,CAAvB,IAA4BL,OAAO,CAACM,MAAR,KAAmB,GAAnD,EAAwD;AACtD,YAAIC,KAAK,GAAGP,OAAO,CAACQ,YAApB;AACAD,QAAAA,KAAK,GAAGA,KAAK,CAACE,KAAN,CAAY,IAAZ,CAAR;;AACA,YAAIF,KAAK,CAACG,MAAN,IAAgB,CAAhB,IAAqBH,KAAK,CAAC,CAAD,CAAL,IAAY,KAArC,EAA4C;AAC1CT,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAWQ,KAAK,CAAC,CAAD,CAA5B;AACD;;AACDT,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAUQ,KAAtB;AACA,eAAOA,KAAP;AACC;AACF,KAXH;;AAYA,WAAO,IAAP;AACD,G;;OAEDI,Y,GAAe,YAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AAEA;AACA,QAAMC,SAAS,GAAG,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAlB;AACA,QAAMtB,MAAM,GAAGkB,SAAS,CAACK,GAAV,CAAc,QAAd,CAAf;AACAnB,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAaL,MAAzB;;AACA,QAAIA,MAAJ,EAAY;AACVI,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;;AACA,UAAImB,KAAK,GAAG,KAAI,CAACzB,QAAL,CAAcC,MAAd,CAAZ;;AACAyB,MAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BF,KAA9B;AACA,aAAOA,KAAP;AACD,KAjBkB,CAkBnB;;;AACApB,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACA,QAAIsB,SAAS,GAAG,KAAI,CAAC7B,MAAL,GAAc,gBAAd,GAAiCI,kBAAkB,CAAC,KAAI,CAACC,UAAL,EAAD,CAAnE;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAesB,SAA3B;AACAP,IAAAA,MAAM,CAACC,QAAP,CAAgBO,IAAhB,GAAuBD,SAAvB;AACD,G;;OAEDxB,U,GAAa,YAAM;AACjB,QAAI0B,GAAG,GAAGT,MAAM,CAACC,QAAP,CAAgBO,IAA1B,CADiB,CAEjB;;AACAC,IAAAA,GAAG,GAAGA,GAAG,CAACd,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAN,CAHiB,CAIjB;;AACAc,IAAAA,GAAG,GAAGA,GAAG,CAACC,OAAJ,CAAY,WAAZ,EAAyB,EAAzB,CAAN;AACA1B,IAAAA,OAAO,CAACC,GAAR,CAAY,SAASwB,GAArB;AACA,WAAOA,GAAP;AACD,G;;;SA3DkBhC,G","sourcesContent":["import React, { Component } from 'react'\nimport { withRouter } from 'react-router-dom'\n\nexport default class Cas {\n  casURL = 'https://fed.princeton.edu/cas/'\n\n  validate = (ticket) => {\n    const val_url = (this.casURL + 'validate?service=' +\n        encodeURIComponent(this.serviceURL()) + '&ticket=' +\n        encodeURIComponent(ticket))\n    console.log('validate url = ' + val_url)\n    var request = new XMLHttpRequest();\n    request.open('GET', val_url, true);\n    request.send();\n    request.onreadystatechange = function () {\n      console.log('url opened')\n      if (request.readyState === 4 && request.status === 200) {\n        var lines = request.responseText;\n        lines = lines.split(\"\\n\")\n        if (lines.length == 2 && lines[0] == 'yes') {\n          console.log('netid:' + lines[1])\n        }\n        console.log('lines' + lines)\n        return lines\n        }\n      }\n    return null\n  }\n\n  authenticate = () => {\n    // is username is stored, then they were already authenticated\n    // var netid = localStorage.getItem('netid')\n    // console.log(netid === null)\n    // if (netid) {\n    //   return netid\n    // }\n\n    // if request has a login ticket, try to validate it\n    const urlParams = new URLSearchParams(window.location.search);\n    const ticket = urlParams.get('ticket');\n    console.log('ticket: ' + ticket)\n    if (ticket) {\n      console.log('ticket received')\n      var netid = this.validate(ticket)\n      localStorage.setItem('netid', netid)\n      return netid\n    }\n    // No valid ticket; redirect the browser to the login page to get one\n    console.log('no ticket found')\n    var login_url = this.casURL + 'login?service=' + encodeURIComponent(this.serviceURL())\n    console.log('Location: ' + login_url)\n    window.location.href = login_url\n  }\n\n  serviceURL = () => {\n    var url = window.location.href;\n    // Remove the \"ticket\" parameter from the URL.\n    url = url.split(\"?\")[0];\n    // Remove a trailing question mark and/or ampersand.\n    url = url.replace(\"\\\\?&?$|&$\", \"\");\n    console.log('url:' + url)\n    return url;\n  }\n\n}\n"]},"metadata":{},"sourceType":"module"}